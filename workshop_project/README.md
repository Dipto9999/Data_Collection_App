# Economics App

## Contents
* [Overview](#Overview)
    * [Data Acquisition](#Data-Acquisition)
        * [Decisions](#Decisions)
        * [Advertisements](#Advertisements)
* [Create App](#Create-App)
* [Deploy App](#Deploy-App)
* [Credit](#Credit)

## Overview
This folder was generated with the necessary components to develop the app with the use of <b>oTree</b> and <b>Django</b> frameworks.</br>
The app is hosted on the cloud using the free version of the <b>Heroku</b> platform. 

### Data Acquisition
The app is capable of acquiring user input from 3 individuals. Each individual is asked whether they wish to</br>
receive a fixed earning (i.e. <i>$100</i>) or a randomly decided earning (i.e. <i>between $50 and $150</i>) a number of 5 times. 

The following single-use links can be used to provide user data :
<ul>
    <li><a href = "https://economics-app-muntakim.herokuapp.com/InitializeParticipant/ntdhqnbv">Individual 1</a></li>    
    <li><a href = "https://economics-app-muntakim.herokuapp.com/InitializeParticipant/46vi4ifh">Individual 2</a></li>
    <li><a href = "https://economics-app-muntakim.herokuapp.com/InitializeParticipant/dmunver3">Individual 3</a></li>
</ul>

#### Decisions
The earnings for the individuals are generated by <i>Custom Functions</i> in the Results_Questionnaire_COVID_1 ... Results_Questionnaire_COVID_5 <i>Classes</i>, found in the <a href = "workshop_app/pages.py">Pages</a> script. The <i>Strings</i> returned are displayed on the <b>HTML</b> files of the same name as the  <i>Class</i>. The user data is stored in the Decision_1 ... Decision_5 <i>Form Fields</i> in the Player <i>Class</i>, found in the <a href = "workshop_app/models.py">Models</a> script. The <i>Custom Function</i> for this process is shown below :

```python
def vars_for_template(self) :
    # Generate a random number between 50 and 150 to a precision of 2 decimal points.
    generated_value = round(random.uniform(50, 150), 2)
    difference = abs(generated_value - 100)

    # Case where player chooses fixed amount and loses out on chance for generated value.
    if ((self.player.Decision_1 == Constants.fixed_amount) and (generated_value > 100)) :
        return {
            'Inform' : 'You have chosen a fixed amount of $100.',
            'Random_Number' : 'Your drawed amount of $' + str(generated_value) + ' would have been greater than the constant amount of $100 by $' + str(round(difference, 2)) + '.'
        }
    # Case where player chooses fixed amount and doesn't lose out on chance for generated value.
    elif ((self.player.Decision_1 == Constants.fixed_amount) and (generated_value < 100)) :
        return {
            'Inform' : 'You have chosen a fixed amount of $100.',
            'Random_Number' : 'Your drawed amount of $' + str(generated_value) + ' would have been less than the constant amount of $100 by $' + str(round(difference, 2)) + '.'
        }
    # Case where player chooses generated value and wins on chance.
    elif ((self.player.Decision_1 == Constants.random_amount) and (generated_value > 100)) :
        return {
            'Inform' : 'You have chosen a random amount instead of the constant amount of $100.',
            'Random_Number' : 'Your drawed amount of $' + str(generated_value) + ' is greater than the constant amount of $100 by $' + str(round(difference, 2)) + '.'                
        }
    # Case where player chooses generated value and makes loss on chance.
    elif ((self.player.Decision_1 == Constants.random_amount) and (generated_value < 100)) :
        return {
            'Inform' : 'You have chosen a random amount instead of the constant amount of $100.',
            'Random_Number' : 'Your drawed amount of $' + str(generated_value) + ' is less than the constant amount of $100 by $' + str(round(difference, 2)) + '.'               
        }
```

#### Advertisements
Similarly, the type of advertisment to display to the individual is determined by the <i>Custom Function</i> in the Input_Quadratic and Input_Investment <i>Classes</i>, found in the <a href = "workshop_app/pages.py">Pages</a> script. The <i>Strings</i> returned are displayed on the <b>HTML</b> files of the same name as the <i>Class</i>. The user data is stored in the Education and Concern <i>Form Fields</i> in the Player <i>Class</i>, found in the <a href = "workshop_app/models.py">Models</a> script. The <i>Custom Function</i> for this process is shown below :

```python
# Function advertises a job for economics students looking for work and 
# face masks for individuals worried about their health.
def vars_for_template(self) :
    # Advertise job fair for economics students worried about finding a job.
    if ((self.player.Concern == Constants.job) and (self.player.Education == Constants.economics)) :
        return {'Advert' : 'Please Sign Up For The Upcoming Job Fair.'}
    # Advertise face masks for individuals worried about their health.
    else :
        return {'Advert' : 'We Have Face Masks Available For Purchase.'}
```

## Create App
The following commands were run using <b>Windows Powershell</b> in the <a href = "https://github.com/Dipto9999/Data_Collection_App">Head</a> directory :
<ul>
    <li>
        <i>otree startproject workshop_project</i> to create the project and Settings file.
        <ul>
            <li><i>n</i> when asked to include sample games.</li>
        </ul>
    </li>
    <li><i>cd workshop_project</i> to enter the newly created project directory.</li>
    <li><i>otree startapp workshop_app</i> to create the <b>Python</b> and <b>HTML</b> files specific to the app.</li>
    <li>
        <i>otree devserver</i> to develop a working version of the app locally.
        <ul>
            <li>Every time you add a change your <b>oTree</b> database, this reformulates your app.</li>
            <li>A working local version of your app will run at <i>http://localhost:8000/demo/</i></li>
        </ul>
    </li>
</ul>

## Deploy App
The following commands were run using <b>Windows Powershell</b> in the 
<a href = "https://github.com/Dipto9999/Data_Collection_App/tree/master/workshop_project">workshop project</a> directory :

<ul>
    <li><i>heroku login -i</i> to provide <b>Heroku</b> login details to the terminal.</li>
    <li><i>git init</i> to get <b>Git</b> started as usual.</li>
    <li><i>heroku create economics-app-muntakim</i> to create the <b>Heroku</b> app.</li>
    <li>
        <i>heroku addons:create heroku-reddis:hobby-dev -a economics-app-muntakim</i> to include Redis Add-On from <b>Heroku</b>.
        <ul>
            <li>You will need to provide Credit Card information to <b>Heroku</b> to include Add-Ons at this stage.</li>
        </ul>
    </li>
    <li><i>pip3 install -U otree</i> to update and install <b>oTree</b>.</li>
    <li><i>otree --version</i> to ensure the latest version of <b>oTree</b> is installed.</li>
    <li><i>git add .</i> to include files from <b>Git</b> Working Tree to Staging Area (Index) as usual.</li>
    <li><i>heroku git:remote -a economics-app-muntakim</i> to specify a <b>Git</b> remote repository located at <i>git.heroku.com</i>.</li>
    <li><i>git commit -am "Creating Heroku App"</i> commits all files from the Staging Area (Index) to <b>Git</b> History.</li>
    <li>
        <i>heroku config:set OTREE_PRODUCTION=1</i> to set the OTREE_PRODUCTION system environment variable</br>
           so that the <b>Heroku</b> server turns off the debug and runs in production mode.
    </li>
    <li>
        <i>heroku config:set OTREE_ADMIN_PASSWORD=*******</i> sets the OTREE_ADMIN_PASSWORD system environment variable</br>
           which specifies the password for your data.
    </li>
    <li><i>git push heroku master</i> to push changes from local <b>Git</b> repository to remote repository.</li>
    <li>
        <i>heroku run "otree resetdb"</i> to reset the <b>oTree</b> database on your <b>Heroku</b> server.
        <ul>
            <li><i>y</i> when asked whether or not to proceed.</li>
        </ul>
    </li>
    <li><i>heroku open</i> to open the <b>Heroku</b> server on your web browser.</li>
</ul>

## Credit
Credit should be provided to <b>Simon Frasier University</b> and <b>Professor Farouk Abdul-Salam</b> for providing
insight into the usage of these tools to create and deploy the app. This was completed as part of an 
<a href = "https://sites.google.com/view/farouk-abdul-salam/my-teaching-workshop/workshop?authuser=0">Online Workshop</a>.